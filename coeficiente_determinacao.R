## ----settings, echo=FALSE-----------------------------------------------------
library(knitr)


## ----importa-dadinhos---------------------------------------------------------
dadinhos <- read.csv("https://raw.githubusercontent.com/piLaboratory/BIE-0320/main/data/dadinho.csv")


## ----mostra-dadinhos, eval=FALSE----------------------------------------------
## dadinhos


## ---- echo=FALSE--------------------------------------------------------------
dadinhos$dif <- dadinhos$Y - mean(dadinhos$Y)


## ---- eval=FALSE--------------------------------------------------------------
## dadinhos$dif <- dadinhos$Y - mean(dadinhos$Y)
## dadinhos


## -----------------------------------------------------------------------------
V.total <- sum(dadinhos$dif^2)


## ---- eval=FALSE--------------------------------------------------------------
## V.total


## -----------------------------------------------------------------------------
dadinhos.lm <- lm(Y ~ X, data=dadinhos)


## ---- echo=FALSE--------------------------------------------------------------
dadinhos.cf <- coef(dadinhos.lm)


## ---- eval=FALSE--------------------------------------------------------------
## (dadinhos.cf <- coef(dadinhos.lm))


## -----------------------------------------------------------------------------
dadinhos$Y.pred <- predict(dadinhos.lm)


## -----------------------------------------------------------------------------
dadinhos$residuo <- dadinhos$Y - dadinhos$Y.pred


## ---- echo=FALSE--------------------------------------------------------------
kable(dadinhos)


## -----------------------------------------------------------------------------
V.resid <- sum(dadinhos$residuo^2)


## ---- eval=FALSE--------------------------------------------------------------
## V.resid


## ---- echo=FALSE--------------------------------------------------------------
V.expl <-  V.total - V.resid


## ---- eval=FALSE--------------------------------------------------------------
## (V.expl <-  V.total - V.resid)


## ---- eval=FALSE--------------------------------------------------------------
## V.expl/V.total


## ---- eval=FALSE--------------------------------------------------------------
## summary(dadinhos.lm)$r.squared

